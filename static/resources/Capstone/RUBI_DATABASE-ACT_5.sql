/*Name: Rubi, Larie Jane
Database Manual - Activity #1
*/

--Problem #1
CREATE DATABASE RUBI_DATABASE;
GO

--Problem #2
USE RUBI_DATABASE;
GO

--Problem #3
CREATE TABLE DEPARTMENT (
    DEPTNO CHAR(3) PRIMARY KEY NOT NULL,
    DEPTNAME VARCHAR(36) NOT NULL,
    MGRNO CHAR(6) NULL,
    ADMRDEPT CHAR(3) NOT NULL,
    LOCATION CHAR(5) NULL
);

--Problem #4
CREATE TABLE EMPLOYEE (
    EMPNO CHAR(6) PRIMARY KEY NOT NULL,
    FIRSTNME VARCHAR(20) NOT NULL,
    MIDINIT CHAR(1) NOT NULL,
    LASTNAME VARCHAR(15) NOT NULL,
    WORKDEPT CHAR(3) NULL,
    PHONENO CHAR(4) NULL,
    HIREDATE DATE NULL,
    JOB CHAR(8) NULL,
    EDLEVEL SMALLINT NULL,
    SEX CHAR(1) NULL,
    BIRTHDATE DATE NULL,
    SALARY DECIMAL(9,2) NULL,
    BONUS DECIMAL(9,2) NULL,
    COMM DECIMAL(9,2) NULL,
);

--Problem #5
CREATE TABLE PROJECT (
    PROJNO CHAR(6) PRIMARY KEY NOT NULL,
    PROJNAME VARCHAR(24) NOT NULL,
    DEPTNO CHAR(3) NOT NULL,
    RESPEMP CHAR(6) NOT NULL,
	PRSTAFF DECIMAL(5,2) NULL,
    PRSTDATE DATE NULL,
    PRENDATE DATE NULL,
    MAJPROJ CHAR(6) NULL,
);

--Problem #6
CREATE TABLE EMP_ACT (
    EMPNO CHAR(6) NOT NULL,
    PROJNO CHAR(6) NOT NULL,
    ACTNO SMALLINT NOT NULL,
    EMPTIME DECIMAL(5,2) NULL,
    EMSTDATE DATE NULL,
    EMENDATE DATE NULL,
);

--Problem #7
EXEC SP_COLUMNS 'DEPARTMENT'; 
EXEC SP_COLUMNS 'EMPLOYEE';
EXEC SP_COLUMNS 'PROJECT';
EXEC SP_COLUMNS 'EMP_ACT';

--Problem #9
EXEC SP_COLUMNS 'DEPARTMENT';

--ALTER TABLE DEPARTMENT ALTER COLUMN MGRNO CHAR(6) NULL; 

--Problem 11
ALTER TABLE DEPARTMENT 
ADD CONSTRAINT FK_DEPARTMENT_MGRNO 
FOREIGN KEY (MGRNO) REFERENCES EMPLOYEE(EMPNO);

--Problem #12
ALTER TABLE DEPARTMENT
ALTER COLUMN LOCATION VARCHAR(30) NOT NULL;

--Problem #13
EXEC sp_rename 'EMP_ACT', 'ACCOUNT';

--Problem #14
CREATE TABLE mytbl(
	MyNumber SMALLINT NOT NULL,
	MyName VARCHAR(3) NOT NULL
);

EXEC sp_rename 'mytbl', 'newtbl';

--to add fk
ALTER TABLE ACCOUNT 
ADD CONSTRAINT FK_EMPLOYEE_EMPNO 
FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO);

ALTER TABLE ACCOUNT 
ADD CONSTRAINT FK_PROJECT_PROJNO 
FOREIGN KEY (PROJNO) REFERENCES PROJECT(PROJNO);

--ACT 2
INSERT INTO DEPARTMENT (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT, LOCATION) VALUES
('A00', 'SPIFFY COMPUTER SERVICE DIV.', NULL, 'A00', ''),
('B01', 'PLANNING', NULL, 'A00', ''),
('C01', 'INFORMATION CENTER', NULL, 'A00', ''),
('D01', 'DEVELOPMENT CENTER', NULL, 'A00', ''),
('D11', 'MANUFACTURING SYSTEMS', NULL, 'D01', ''),
('D21', 'ADMINISTRATION SYSTEMS', NULL, 'D01', ''),
('E01', 'SUPPORT SERVICES', NULL, 'A00', ''),
('E11', 'OPERATIONS', NULL, 'E01', ''),
('E21', 'SOFTWARE SUPPORT', NULL, 'E01', '');

INSERT INTO EMPLOYEE (EMPNO, FIRSTNME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, JOB, EDLEVEL, SEX, BIRTHDATE, SALARY, BONUS, COMM) VALUES
('000010', 'CHRISTINE', 'I', 'HAAS', NULL, 3978, '1965-01-01', 'PRES', 18, 'F', '1933-08-14', 52750.00, 1000.00, 4220.00),
('000020', 'MICHAEL', 'L', 'THOMPSON', NULL, 3476, '1973-10-10', 'MANAGER', 18, 'M', '1948-02-02', 41250.00, 800.00, 3300.00),
('000030', 'SALLY', 'A', 'KWAN', NULL, 4738, '1975-04-05', 'MANAGER', 20, 'F', '1941-05-11', 38250.00, 800.00, 3060.00),
('000040', 'JOHN', 'B', 'GEYER', NULL, 6789, '1949-08-17', 'MANAGER', 16, 'M', '1925-09-15', 40175.00, 800.00, 3214.00),
('000060', 'IRVING', 'F', 'STERN', NULL, 6423, '1973-09-14', 'MANAGER', 16, 'M', '1945-07-07', 32250.00, 600.00, 2580.00),
('000070', 'EVA', 'D', 'PULASKI', NULL, 7831, '1980-09-30', 'MANAGER', 16, 'F', '1953-05-26', 36170.00, 700.00, 2893.00),
('000090', 'EILEEN', 'W', 'HENDERSON', NULL, 5498, '1970-08-15','MANAGER', 16, 'F', '1941-05-15', 29750.00, 600.00, 2380.00),
('000100', 'THEODORE', 'Q', 'SPENSER', NULL, 0972, '1980-06-19','MANAGER', 14, 'M', '1956-12-18', 26150.00, 500.00, 2092.00),
('000110', 'VINCENZO', 'G', 'LUCCHESI', NULL, 3490, '1958-05-16','SALESREP', 19, 'M', '1929-11-05', 46500.00, 900.00, 3720.00),
('000120', 'SEAN', 'O', 'O''CONNELL', NULL, 2167, '1963-12-05','CLERK', 14, 'M', '1942-10-18', 29250.00, 600.00, 2340.00),
('000130', 'DOLORES', 'M', 'QUINTANA', NULL, 4578, '1971-07-28','ANALYST', 16, 'F', '1925-09-15', 23800.00, 500.00, 1904.00),
('000140', 'HEATHER', 'A', 'NICHOLLS', NULL, 1793, '1976-12-15','ANALYST', 18, 'F', '1946-01-19', 28420.00, 600.00, 2274.00),
('000150', 'BRUCE', '', 'ADAMSON', NULL, 4510, '1972-02-12','DESIGNER', 16, 'M', '1947-05-17', 25280.00, 500.00, 2022.00),
('000160', 'ELIZABETH', 'R', 'PIANKA', NULL, 3782, '1977-10-11','DESIGNER', 17, 'F', '1955-04-12', 22250.00, 400.00, 1780.00),
('000170', 'MASATOHI', 'J', 'YOSHIMURA', NULL, 2890, '1978-09-15','DESIGNER', 16, 'M', '1951-01-05', 24680.00, 500.00, 1974.00),
('000180', 'MARILYN', 'S', 'SCOUTTEN', NULL, 1682, '1973-07-07','DESIGNER', 17, 'F', '1949-02-21', 21340.00, 500.00, 1707.00),
('000190', 'JAMES', 'H', 'WALKER', NULL, 2986, '1974-06-01','DESIGNER', 16, 'M', '1952-06-25', 20450.00, 400.00, 1636.00),
('000200', 'DAVID', 'T', 'BROWN', NULL, 4507, '1977-09-12','DESIGNER', 16, 'M', '1941-05-29', 27740.00, 600.00, 2217.00),
('000210', 'WILLIAM', 'T', 'JONES', NULL, 0942, '1979-03-05','DESIGNER', 17, 'M', '1953-02-23', 18270.00, 400.00, 1462.00),
('000220', 'JENNIFER', 'K', 'LUTZ', NULL, 0672, '1968-08-29','DESIGNER', 18, 'F', '1948-03-19', 29840.00, 600.00, 2387.00),
('000230', 'JAMES', 'J', 'JEFFERSON', NULL, 4265, '1966-11-21','CLERK', 14, 'M', '1935-05-30', 22180.00, 400.00, 1774.00),
('000240', 'SALVATORE', 'S', 'MARINO', NULL, 9533, '1979-12-05','CLERK', 17, 'M', '1954-03-31', 28760.00, 600.00, 2301.00),
('000250', 'DANIEL', 'V', 'SMITH', NULL, 8951, '1969-10-30','CLERK', 15, 'M', '1939-11-12', 19180.00, 400.00, 1534.00),
('000260', 'SYBIL', 'S', 'JOHNSON', NULL, 8953, '1975-09-11','CLERK', 16, 'F', '1936-10-05', 17250.00, 300.00, 1380.00),
('000270', 'MARIA', 'L', 'PEREZ', NULL, 9001, '1980-09-30','CLERK', 15, 'F', '1953-05-26', 27380.00, 500.00, 2190.00),
('000280', 'ETHEL', 'R', 'SCHNEIDER', NULL, 8997, '1970-03-24','OPERATOR', 17, 'F', '1936-03-28', 26250.00, 500.00, 2100.00),
('000290', 'JOHN', 'R', 'PARKER', NULL, 4502, '1966-06-19','OPERATOR', 12, 'M', '1946-07-09', 15340.00, 300.00, 1227.00),
('000300', 'PHILIP', 'X', 'SMITH', NULL, 4505, '1972-06-19','OPERATOR', 14, 'M', '1936-10-27', 17750.00, 400.00, 1420.00),
('000310', 'MAUDE', 'F', 'SETRIGHT', NULL, 3392, '1964-07-02','OPERATOR', 12, 'F', '1931-04-21', 15900.00, 300.00, 1272.00),
('000320', 'RAMLAL', 'V', 'MEHTA', NULL, 9990, '1965-03-29','FIELDREP', 16, 'M', '1932-08-11', 19950.00, 400.00, 1596.00),
('000330', 'WING', '', 'LEE', NULL, 2103, '1976-02-23','FIELDREP', 14, 'M', '1941-07-18', 25370.00, 500.00, 2030.00),
('000340', 'JASON', 'R', 'GOUNOT', NULL, 5698, '1947-05-05','FIELDREP', 16, 'M', '1926-05-17', 23840.00, 500.00, 1907.00); --WORKDEPT IS NULL INITIALLY

INSERT INTO PROJECT (PROJNO, PROJNAME, DEPTNO, RESPEMP, PRSTAFF, PRSTDATE, PRENDATE, MAJPROJ) VALUES  --wala na populate
('AD3100', ' ADMIN SERVICES', 'D21', '000010', 6.00, '1982-01-01', '1983-02-01', ''),
('AD3110', 'GENERAL AD SYSTEMS', 'D21', '000070', 6.00, '1982-01-01', '1983-02-01', 'AD3100'),
('AD3111', 'PAYROLL PROGRAMMING', 'D21', '000230', 2.00, '1982-01-01', '1983-02-01', 'AD3110'),
('AD3112', 'PERSONNEL PROGRAMS', 'D21', '000250', 1.00, '1982-01-01', '1983-02-01', 'AD3110'),
('AD3113', 'ACCOUNT PROGRAMMING', 'D21', '000270', 2.00, '1982-01-01', '1983-02-01', 'AD3110'),
('IF1000', 'QUERY SERVICES', 'C01', '000030', 2.00, '1982-01-01', '1983-02-01', ''),
('IF2000', 'USER EDUCATION', 'C01', '000030', 1.00, '1982-01-01', '1983-02-01', ''),
('MA2100', 'WELD LINE AUTOMATION', 'D11', '000010', 12.00, '1982-01-01', '1983-02-01', ''),
('MA2110', 'W L PROGRAM DESIGN', 'D11', '000060', 9.00, '1982-01-01', '1983-02-01', 'MA2100'),
('MA2111', 'W L PROGRAMMING', 'D11', '000220', 2.00, '1982-01-01', '1982-12-01', 'MA2110'),
('MA2112', 'W L ROBOT DESIGN', 'D11', '000150', 3.00, '1982-01-01', '1982-12-01', 'MA2110'),
('MA2113', 'W L PROD CONT PROGS', 'D11', '000160', 3.00, '1982-02-15', '1982-12-01', 'MA2110'),
('OP1000', 'OPERATION SUPPORT', 'E11', '000050', 6.00, '1982-01-01', '1983-02-01', ''),
('OP1010', 'OPERATION', 'E11', '000090', 5.00, '1982-01-01', '1983-02-01', 'OP1000'),
('OP2000', 'GEN SYSTEMS SERVICES', 'E21', '000050', 5.00, '1982-01-01', '1983-02-01', ''),
('OP2010', 'SYSTEMS SUPPORT', 'E21', '000100', 4.00, '1982-01-01', '1983-02-01', 'OP2000'),
('OP2011', 'SCP SYSTEMS SUPPORT', 'E21', '000320', 1.00, '1982-01-01', '1983-02-01', 'OP2010'),
('OP2012', 'APPLICATIONS SUPPORT', 'E21', '000330', 1.00, '1982-01-01', '1983-02-01', 'OP2010'),
('OP2013', 'DB/DC SUPPORT', 'E21', '000340', 1.00, '1982-01-01', '1983-02-01', 'OP2010'),
('PL2100', 'WELD LINE PLANNING', 'B01', '000020', 1.00, '1982-01-01', '1982-09-15', 'MA2100');

UPDATE DEPARTMENT SET MGRNO='000010' WHERE DEPTNO= 'A00';
UPDATE DEPARTMENT SET MGRNO='000020' WHERE DEPTNO= 'B01';
UPDATE DEPARTMENT SET MGRNO='000030' WHERE DEPTNO= 'C01';
UPDATE DEPARTMENT SET MGRNO= NULL WHERE DEPTNO= 'D01';
UPDATE DEPARTMENT SET MGRNO='000060' WHERE DEPTNO= 'D11'; 
UPDATE DEPARTMENT SET MGRNO='000070' WHERE DEPTNO= 'D21';
UPDATE DEPARTMENT SET MGRNO='000050' WHERE DEPTNO= 'E01'; --CHECK
UPDATE DEPARTMENT SET MGRNO='000090' WHERE DEPTNO= 'E11';
UPDATE DEPARTMENT SET MGRNO='000100' WHERE DEPTNO= 'E21';

UPDATE DEPARTMENT SET LOCATION='R. PALMA ST. CEBU CITY' WHERE DEPTNO='A00'; --only the first 5 naay location sa table kay mao raman gipa update
UPDATE DEPARTMENT SET LOCATION='CCIT BLDG. 2ND FLR.' WHERE DEPTNO='B01';
UPDATE DEPARTMENT SET LOCATION='CCIT BLDG. 2ND FLR.' WHERE DEPTNO='C01';
UPDATE DEPARTMENT SET LOCATION='CCIT BLDG. 3RD FLR.' WHERE DEPTNO='D01';
UPDATE DEPARTMENT SET LOCATION='CCIT BLDG. 1ST FLR.' WHERE DEPTNO='D11';


DELETE FROM EMPLOYEE WHERE EMPNO='000340';

UPDATE EMPLOYEE SET WORKDEPT='A00' WHERE EMPNO='000010';
UPDATE EMPLOYEE SET WORKDEPT='B01' WHERE EMPNO='000020';
UPDATE EMPLOYEE SET WORKDEPT='C01' WHERE EMPNO='000030';
UPDATE EMPLOYEE SET WORKDEPT='E01' WHERE EMPNO='000050';
UPDATE EMPLOYEE SET WORKDEPT='D11' WHERE EMPNO='000060'; --
UPDATE EMPLOYEE SET WORKDEPT='D21' WHERE EMPNO='000070';--NA INSERT
UPDATE EMPLOYEE SET WORKDEPT='E11' WHERE EMPNO='000090';
UPDATE EMPLOYEE SET WORKDEPT='E21' WHERE EMPNO='000100';
UPDATE EMPLOYEE SET WORKDEPT='A00' WHERE EMPNO='000110';
UPDATE EMPLOYEE SET WORKDEPT='A00' WHERE EMPNO='000120';
UPDATE EMPLOYEE SET WORKDEPT='C01' WHERE EMPNO='000130';
UPDATE EMPLOYEE SET WORKDEPT='C01' WHERE EMPNO='000140';
UPDATE EMPLOYEE SET WORKDEPT='D11' WHERE EMPNO='000150';
UPDATE EMPLOYEE SET WORKDEPT='D11' WHERE EMPNO='000160';
UPDATE EMPLOYEE SET WORKDEPT='D11' WHERE EMPNO='000170';
UPDATE EMPLOYEE SET WORKDEPT='D11' WHERE EMPNO='000180';
UPDATE EMPLOYEE SET WORKDEPT='D11' WHERE EMPNO='000190';
UPDATE EMPLOYEE SET WORKDEPT='D11' WHERE EMPNO='000200';
UPDATE EMPLOYEE SET WORKDEPT='D11' WHERE EMPNO='000210';
UPDATE EMPLOYEE SET WORKDEPT='D11' WHERE EMPNO='000220';
UPDATE EMPLOYEE SET WORKDEPT='D21' WHERE EMPNO='000230';
UPDATE EMPLOYEE SET WORKDEPT='D21' WHERE EMPNO='000240';
UPDATE EMPLOYEE SET WORKDEPT='D21' WHERE EMPNO='000250';
UPDATE EMPLOYEE SET WORKDEPT='D21' WHERE EMPNO='000260';
UPDATE EMPLOYEE SET WORKDEPT='D21' WHERE EMPNO='000270';
UPDATE EMPLOYEE SET WORKDEPT='E11' WHERE EMPNO='000280';
UPDATE EMPLOYEE SET WORKDEPT='E11' WHERE EMPNO='000290';
UPDATE EMPLOYEE SET WORKDEPT='E11' WHERE EMPNO='000300';
UPDATE EMPLOYEE SET WORKDEPT='E11' WHERE EMPNO='000310';
UPDATE EMPLOYEE SET WORKDEPT='E21' WHERE EMPNO='000320';
UPDATE EMPLOYEE SET WORKDEPT='E21' WHERE EMPNO='000330';
UPDATE EMPLOYEE SET WORKDEPT='E21' WHERE EMPNO='000340';

SELECT * FROM DEPARTMENT;
SELECT * FROM EMPLOYEE;
SELECT * FROM ACCOUNT;
SELECT * FROM PROJECT;


INSERT INTO ACCOUNT(EMPNO, PROJNO, ACTNO, EMPTIME, EMSTDATE, EMENDATE) VALUES --wala na populate
('000010', 'AD3100', 10, 0.50, '1982-01-01', '1982-07-01'),
('000070', 'AD3110', 10, 1.00, '1982-01-01', '1983-02-01'),
('000230', 'AD3111', 60, 1.00, '1982-01-01', '1982-03-15'),
('000230', 'AD3111', 61, 0.50, '1982-03-15', '1982-04-15'), 
('000230', 'AD3111', 70, 0.50, '1982-03-15', '1982-10-15'),
('000230', 'AD3111', 80, 0.50, '1982-04-15', '1982-10-15'),
('000230', 'AD3111', 180, 1.00, '1982-03-15', '1983-01-01'),
('000240', 'AD3111', 70, 1.00, '1982-02-15', '1982-09-15'),
('000240', 'AD3111', 81, 1.00, '1982-03-15', '1983-01-01'), 
('000250', 'AD3112', 60, 1.00, '1982-01-01', '1982-02-01'),
('000250', 'AD3112', 70, 1.00, '1982-03-15', '1982-08-15'), 
('000250', 'AD3112', 81, 0.25, '1982-08-15', '1982-10-15'), 
('000250', 'AD3112', 180, 0.50, '1982-08-15', '1983-01-01'),
('000260', 'AD3113', 70, 0.50, '1982-06-15', '1982-07-01'),
('000260', 'AD3113', 71, 1.00, '1982-07-01', '1982-09-01'), 
('000260', 'AD3113', 82, 1.00, '1982-01-01', '1982-03-01'), 
('000260', 'AD3113', 83, 0.50, '1982-03-01', '1982-04-15'),
('000260', 'AD3113', 181, 0.50, '1982-03-15', '1982-06-01'), 
('000270', 'AD3113', 61, 0.25, '1982-09-01', '1982-10-15'), 
('000270', 'AD3113', 62, 1.00, '1982-03-01', '1982-09-01'), 
('000270', 'AD3113', 71, 0.75, '1982-09-01', '1982-10-15'), 
('000270', 'AD3113', 70, 1.00, '1982-10-15', '1982-12-01'),
('000270', 'AD3113', 80, 1.00, '1982-01-01', '1982-03-01'),
('000270', 'AD3113', 81, 0.50, '1982-03-01', '1982-04-01'), 
('000030', 'IF1000', 10, 0.50, '1982-06-01', '1983-01-01'),
('000130', 'IF1000', 90, 1.00, '1982-01-01', '1982-10-01'),
('000130', 'IF1000', 100, 0.50, '1982-10-01', '1983-01-01'),
('000140', 'IF1000', 90, 0.50, '1982-10-01', '1983-01-01');

--ACT 3
SELECT EMPNO, LASTNAME, BIRTHDATE, SALARY
FROM EMPLOYEE
WHERE SALARY > 30000
ORDER BY SALARY DESC;

SELECT E.LASTNAME, E.FIRSTNME, D.DEPTNO
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.WORKDEPT = D.DEPTNO
ORDER BY D.DEPTNO DESC, E.LASTNAME DESC;

SELECT DISTINCT EDLEVEL
FROM EMPLOYEE
ORDER BY EDLEVEL DESC;

SELECT DISTINCT EMPNO, PROJNO   --REMINDER: empty pa ang emp_act asta project
FROM ACCOUNT  
WHERE EMPNO <= 100  
ORDER BY EMPNO;

SELECT LASTNAME, SALARY, BONUS  
FROM EMPLOYEE  
WHERE SEX = 'M';

SELECT LASTNAME, SALARY, COMM  --si pulaski pa kay walay data ang empact ug project
FROM EMPLOYEE  
WHERE SALARY > 29000  
AND HIREDATE > '1979-12-31';

SELECT LASTNAME, SALARY, BONUS, COMM  
FROM EMPLOYEE  
WHERE (SALARY > 22000 AND BONUS = 400)  
   OR (BONUS = 500 AND COMM < 1900)  
ORDER BY LASTNAME;

SELECT LASTNAME, SALARY, BONUS, COMM  
FROM EMPLOYEE  
WHERE SALARY > 22000  
AND (BONUS = 400 OR (BONUS = 500 AND COMM < 1900))  
ORDER BY LASTNAME;

SELECT DEPTNO, DEPTNAME  
FROM DEPARTMENT  
WHERE DEPTNO LIKE '_1_';

--skip sa number 10 kay wala sulod ang empact table

SELECT MGRNO, DEPTNO --recheck kay wala si 000050
FROM DEPARTMENT
WHERE MGRNO IS NOT NULL
ORDER BY MGRNO;

SELECT EMPNO, LASTNAME, SALARY, BONUS --geyer should be 000050 balika
FROM EMPLOYEE
WHERE BONUS BETWEEN 800 AND 1000
ORDER BY BONUS ASC, EMPNO ASC;

--naay wrongings number 13 recheck lang nya

SELECT PROJNO, PROJNAME --recheck kay empty ang project table
FROM PROJECT
WHERE PROJNAME LIKE '%SUPPORT%'
ORDER BY PROJNO;

SELECT DEPTNO, DEPTNAME, MGRNO
FROM DEPARTMENT
WHERE SUBSTRING(DEPTNO, 2, 1) = '1'
ORDER BY DEPTNO;

--ACTIVITY 4 
--1
SELECT E.LASTNAME, E.FIRSTNME, D.DEPTNAME
FROM EMPLOYEE E
LEFT JOIN DEPARTMENT D ON E.WORKDEPT = D.DEPTNO
ORDER BY D.DEPTNAME, E.LASTNAME, E.FIRSTNME;
--2
SELECT E.LASTNAME, E.FIRSTNME, D.DEPTNAME, E.JOB
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.WORKDEPT = D.DEPTNO
WHERE D.DEPTNO BETWEEN 'A02' AND 'D22' AND E.JOB <> 'MANAGER'
ORDER BY D.DEPTNAME, E.JOB, E.LASTNAME, E.FIRSTNME;
--3
SELECT D.DEPTNAME, E.LASTNAME, E.FIRSTNME
FROM DEPARTMENT D
LEFT JOIN EMPLOYEE E ON D.MGRNO = E.EMPNO
ORDER BY D.DEPTNAME;
--4
SELECT D.DEPTNAME, E.LASTNAME, E.FIRSTNME
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.WORKDEPT = D.DEPTNO
WHERE E.JOB = 'MANAGER'
ORDER BY D.DEPTNAME;
--Answer: The results from both queries will not be the same because:
--Query 3 relates departments to employees based on MGRNO = EMPNO, ensuring only managers assigned in the DEPARTMENT table are included.
--Query 4 finds managers by using WORKDEPT = DEPTNO, meaning any employee with the title "MANAGER" is included, 
--even if they are not explicitly assigned in the department table.

--5
SELECT DISTINCT P.PROJNO, P.PROJNAME, A.ACTNO
FROM PROJECT P
JOIN ACCOUNT A ON P.PROJNO = A.PROJNO
WHERE P.PROJNO LIKE 'AD%'
ORDER BY P.PROJNO, A.ACTNO;

--6
SELECT DISTINCT A.EMPNO, E.LASTNAME, A.PROJNO
FROM ACCOUNT A
JOIN EMPLOYEE E ON A.EMPNO = E.EMPNO
WHERE A.PROJNO = 'AD3113'
ORDER BY A.EMPNO, A.PROJNO;

--7
SELECT A.EMPNO, A.PROJNO, P.PROJNAME, A.ACTNO, A.EMSTDATE
FROM ACCOUNT A
JOIN PROJECT P ON A.PROJNO = P.PROJNO
WHERE A.EMSTDATE = '1982-10-01'
ORDER BY A.PROJNO, A.EMPNO, A.ACTNO;

--8
SELECT E.WORKDEPT, E.LASTNAME, P.PROJNAME, A.ACTNO
FROM ACCOUNT A
JOIN EMPLOYEE E ON A.EMPNO = E.EMPNO
JOIN PROJECT P ON A.PROJNO = P.PROJNO
WHERE E.WORKDEPT = 'A00'
ORDER BY P.PROJNAME, A.ACTNO;

--9
SELECT DISTINCT E.WORKDEPT, E.LASTNAME, P.PROJNAME, A.ACTNO
FROM ACCOUNT A
JOIN EMPLOYEE E ON A.EMPNO = E.EMPNO
JOIN PROJECT P ON A.PROJNO = P.PROJNO
WHERE E.WORKDEPT BETWEEN 'A00' AND 'C01'
ORDER BY E.WORKDEPT, E.LASTNAME, A.ACTNO;


--10
SELECT A.ACTNO, D.MGRNO, A.EMSTDATE, A.PROJNO, E.LASTNAME
FROM ACCOUNT A
JOIN EMPLOYEE E ON A.EMPNO = E.EMPNO
JOIN PROJECT P ON A.PROJNO = P.PROJNO
JOIN DEPARTMENT D ON P.DEPTNO = D.DEPTNO
WHERE A.EMSTDATE >= '1982-10-15'
ORDER BY A.ACTNO, A.EMSTDATE;

--11
SELECT E.WORKDEPT, M.LASTNAME AS MANAGER_LASTNAME, E.LASTNAME AS EMPLOYEE_LASTNAME, 
       M.HIREDATE AS MANAGER_HIREDATE, E.HIREDATE AS EMPLOYEE_HIREDATE
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.WORKDEPT = D.DEPTNO
JOIN EMPLOYEE M ON D.MGRNO = M.EMPNO
WHERE E.WORKDEPT = 'A00' AND E.HIREDATE < M.HIREDATE
ORDER BY E.LASTNAME;


--ACTIVITY #5
--1
SELECT 
    LASTNAME, 
    SALARY AS CURRENT_SALARY, 
    FORMAT(SALARY * 1.05, 'N2') AS INC_Y_SALARY, 
    FORMAT((SALARY * 1.05) / 12, 'N2') AS INC_M_SALARY
FROM EMPLOYEE
WHERE (SALARY * 1.05) <= 20000.00
ORDER BY SALARY;
--2
SELECT 
    LASTNAME, 
    EDLEVEL, 
    SALARY + 1200 AS NEW_SALARY, 
    FORMAT(BONUS / 2, 'N2') AS NEW_BONUS
FROM EMPLOYEE
WHERE EDLEVEL IN (18, 20)
ORDER BY EDLEVEL DESC, SALARY;
--3
SELECT 
    WORKDEPT AS DEPTNO, 
    LASTNAME, 
    SALARY, 
    SALARY - 1000 AS DECR_SALARY
FROM EMPLOYEE
WHERE WORKDEPT = 'D11' 
AND SALARY BETWEEN (20000 * 0.8) AND (20000 * 1.2)
ORDER BY SALARY;
--4
SELECT 
    WORKDEPT AS DEPTNO, 
    LASTNAME, 
    (SALARY + BONUS + COMM) AS INCOME
FROM EMPLOYEE
WHERE WORKDEPT = 'D11' 
AND (SALARY + BONUS + COMM) > (SALARY * 1.10)
ORDER BY INCOME DESC;
--5
SELECT 
    DEPTNO, 
    DEPTNAME, 
    COALESCE(CAST(MGRNO AS VARCHAR), 'UNKNOWN') AS MGRNO
FROM DEPARTMENT
WHERE MGRNO IS NULL;
--6
SELECT 
    PROJNO, 
    COALESCE(MAJPROJ, 'MAIN PROJECT') AS MAJOR_PROJECT
FROM PROJECT
WHERE PROJNO LIKE 'MA%'
ORDER BY PROJNO;
--7
SELECT 
    EMPNO, 
    LASTNAME, 
    DATEDIFF(YEAR, BIRTHDATE, HIREDATE) AS AGE
FROM EMPLOYEE
WHERE DATEDIFF(YEAR, BIRTHDATE, HIREDATE) < 25
ORDER BY AGE, EMPNO;
--8
SELECT 
    YEAR(PRSTDATE) AS YEAR, 
    MONTH(PRSTDATE) AS MONTH, 
    PROJNO
FROM PROJECT
WHERE PRENDATE = '1982-12-01'
ORDER BY PROJNO;
--9
SELECT 
    PROJNO, 
    FORMAT(DATEDIFF(DAY, PRSTDATE, PRENDATE) / 7.0, 'N1') AS WEEKS
FROM PROJECT
WHERE PROJNO LIKE 'MA%'
ORDER BY PROJNO;
--10
SELECT 
    PROJNO, 
    PRENDATE AS ESTIMATED, 
    DATEADD(DAY, DATEDIFF(DAY, PRSTDATE, PRENDATE) * 0.10, PRENDATE) AS EXPECTED
FROM PROJECT
WHERE PROJNO LIKE 'MA%'
ORDER BY PROJNO;
--11
SELECT 
    DATEDIFF(DAY, '1969-07-20', '2000-01-01') AS DAYS;

--LAB ACTIVITY #8
--1
SELECT 
    e.WORKDEPT AS DepartmentNumber, 
    e.EMPNO AS EmployeeNumber, 
    e.LASTNAME, 
    e.SALARY
FROM 
    EMPLOYEE e
WHERE 
    e.SALARY >= (SELECT AVG(SALARY) + 500 FROM EMPLOYEE)
ORDER BY 
    e.WORKDEPT, 
    e.EMPNO;
--2
SELECT 
    EMPNO,
    LASTNAME
FROM 
    EMPLOYEE
WHERE 
    EMPNO NOT IN (
        SELECT DISTINCT EMPNO 
        FROM ACCOUNT
);
--3
SELECT 
    PROJNO,
    DATEDIFF(day, PRSTDATE, PRENDATE) AS DAYS
FROM 
    PROJECT
WHERE 
    DATEDIFF(day, PRSTDATE, PRENDATE) = (
        SELECT MIN(DATEDIFF(day, PRSTDATE, PRENDATE))
        FROM PROJECT
        WHERE PRSTDATE IS NOT NULL 
        AND PRENDATE IS NOT NULL
);
--4
SELECT 
    d.DEPTNO,
    d.DEPTNAME,
    e.LASTNAME,
    e.FIRSTNME
FROM 
    DEPARTMENT d
JOIN 
    EMPLOYEE e ON d.DEPTNO = e.WORKDEPT
WHERE 
    d.DEPTNO IN (
        SELECT WORKDEPT 
        FROM EMPLOYEE 
        WHERE WORKDEPT IS NOT NULL
        GROUP BY WORKDEPT
        HAVING SUM(CASE WHEN SEX = 'F' THEN 1 ELSE 0 END) = 0
    )
ORDER BY 
    d.DEPTNO, 
    e.LASTNAME;
--5
SELECT 
    e.LASTNAME,
    e.JOB,
    e.EDLEVEL,
    DATEDIFF(year, e.HIREDATE, '2000-01-01') AS YEARS,
    e.SALARY
FROM 
    EMPLOYEE e
WHERE 
    e.JOB = (SELECT JOB FROM EMPLOYEE WHERE LASTNAME = 'STERN')
    AND
    e.EDLEVEL = (SELECT EDLEVEL FROM EMPLOYEE WHERE LASTNAME = 'STERN')
ORDER BY 
    e.SALARY DESC;

--LAB ACTIVITY 9









